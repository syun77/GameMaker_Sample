<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// 変数初期化
// 背景
//bg = bg_back;
bg = background_duplicate(bg_back);
// キャラ
//ch = spr_char;
ch = sprite_duplicate(spr_char);
// メッセージ
message = "";

// フォントを有効にする
draw_set_font(fnt_adv);

// スクリプト読み込み
script = file_text_open_read("script.txt");
// スクリプトを実行
event_perform(ev_other, ev_user0);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// 各種リソースの破棄
// 背景
background_delete(bg);
// キャラ
sprite_delete(ch);
// スクリプトファイルを閉じる
file_text_close(script);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="10">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// スクリプトを実行
while(true)
{

// ファイル終端チェック
if(file_text_eof(script))
{
  // スクリプト終了
  instance_destroy();
  break;
}

// 1行読み込み
var line = file_text_read_string(script);
// コマンド取得
var index = string_pos(",", line);
var cmd = string_copy(line, 0, index-1);
//show_debug_message(cmd);

// コマンド以降の文字列を切り出して取得
var str = string_copy(line, index+1, 65535);
// パラメータ取得
var params;
params[0] = 0;
var idx = 0;
while(true)
{
  index = string_pos(",", str);
  if(index == 0)
  {
    // 次のパラメータがないのでそのまま代入
    params[idx] = str;
  }
  else
  {
    params[idx] = string_copy(line, 0, index-1);
  }
  //show_debug_message(params[idx]);
  idx++;
  if(index == 0)
  {
    // パラメータ取得おしまい
    break;
  }
  
  // 次のパラメータを取得
  str = string_copy(str, index, 65535);
  //show_debug_message(str);
}

// コマンド実行・スクリプト実行終了判定
var bExit = false;
switch(cmd)
{
case "msg":
  // テキスト表示
  message = params[0];
  bExit = true;
  break;
case "bg":
  // 背景表示
  // いったん削除
  background_delete(bg);
  // ファイル名を作成して読み込み
  var filename = "bg" + params[0] + ".jpg";
  bg = background_add(filename, false, false);
  break;
case "ch":
  // キャラクター表示
  // いったん削除
  sprite_delete(ch);
  // ファイル名を作成して読み込み
  var filename = "ch" + params[0] + ".png";
  ch = sprite_add(filename, 1, false, false, 0, 0);  break;
}

  // 次の行に進める
  file_text_readln(script);

if(bExit)
{
  // ゲームに制御を返す
  break;
}

} // スクリプト解析ループの終端

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// 描画
// 背景を描画
draw_background(bg, 0, 0);
// キャラを描画
draw_sprite(ch, 0, 0, 0);
// メッセージウィンドウを描画
draw_sprite(spr_window, 0, 0, 320);
// テキスト描画
draw_set_colour(c_white);
draw_text(16, 320+48, message);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="32">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// メッセージ送り
// スクリプトを実行
event_perform(ev_other, ev_user0);

</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
